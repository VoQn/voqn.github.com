var force=function(b){return b()},flip=function(b){return function(c,a){return b(a,c)}},isList=function(){return Array.isArray?Array.isArray:function(b){return"[object Array]"===Object.prototype.toString.call(b)}}(),isEmpty=function(){for(var b in obj)return!1;return!0},clone=function(b){for(var c=Object.create(Object.getPrototypeOf(b)),a=Object.getOwnPropertyNames(b),d=0,e;e=a[d];d++)Object.defineProperty(c,e,Object.getOwnPropertyDescriptor(b,e));return c},map=function(b,c){var a,d,e;if(isList(c)){a=
[];d=0;for(e=c.length;d<e;d++)a[d]=b(c[d],d);return a}a=Object.create(Object.getPrototypeOf(c));for(d in c)c.hasOwnProperty(d)&&(a[d]=b(c[d],d));return a},each=function(b,c){var a,d;if(isList(c)){a=0;for(d=c.length;a<d;a++)b(c[a],a)}else for(a in c)c.hasOwnProperty(a)&&b(c[a],a)},filter=function(b,c){for(var a=[],d=0,e=0,f=c.length,g;d<f;d++)g=c[d],b(g,d)&&(a[e]=g,e++);return a},hasAny=function(b,c){for(var a=0,d=c.length;a<d;a++)if(b(c[a],a))return!0;return!1},hasAll=function(b,c){for(var a=0,d=
c.length;a<d;a++)if(!b(c[a],a))return!1;return!0},foldLeft=function(b,c,a){for(var d=0,e=a.length;d<e;d++)b=c(a[d],b);return b},foldRight=function(b,c,a){for(var d=a.length-1;-1<d;d--)b=c(a[d],b);return b},sumOf=function(b){for(var c=0,a=0,d=b.length;a<d;a++)c+=b[a];return c},supplement=function(b,c,a){return void 0===c?b:void 0===a?c:a(b,c)},Tuple=function(b,c){this.fst=b;this.snd=c},tuple=function(b,c){return new Tuple(b,c)},whatTimeIsNow=function(){return(new Date).getTime()},printTime=function(b,
c){var a=supplement(whatTimeIsNow(),c)-b;return 6E4<a?a/6E4+"min":1E3<a?a/1E3+"s":a+"ms"};function Interface(b,c){if(2!=arguments.length)throw Error("Interface constructor called with "+arguments.length+"arguments, but expected exactly 2.");this.name=b;this.methods=[];for(var a=0,d=c.length;a<d;a++){if("string"!==typeof c[a])throw Error("Interface constructor expects method names to be passed in as a string");this.methods.push(c[a])}}
Interface.ensureImplements=function(b,c,a){if(2>arguments.length)throw Error("Function Interface.ensureImplements called with "+arguments.length+"arguments, but expected at least 2.");for(var d=1,e=0,f,g;g=arguments[d];d++){if(g.constructor!==Interface)throw Error("Function Interface.ensureImplements expects arguments two and above to be instance of Interface.");for(;f=g.methods[e];e++)if(!b[f]||"function"!==typeof b[f])throw Error("Function Interface.ensureImplements: object does not implement the "+
g.name+" interface. Method "+f+" was not found.");}};function Result(){this.skipped=this.passed=!1;this.reason="Test has not run yes";this.arguments=[]}var currentResult=new Result;function SkippedTest(){this.wasSkipped=!0}
var skippedTest=new SkippedTest,forAll=function(b,c){var a=isList(b)?b:[a],d=[],e;return function(b){d=map(function(a){return a(b)},a);try{e=c.apply(c,d)}catch(g){return currentResult.passed=!1,currentResult.skipped=!1,currentResult.reason="Exception occurred: "+g,currentResult.arguments=d,currentResult}e.wasSkipped?(currentResult.passed=!1,currentResult.skipped=!0,currentResult.reason="Skipped: ("+d.join(", ")+")"):(currentResult.passed=e,currentResult.skipped=!1,currentResult.reason=e?"":"Falsible: ("+
d.join(", ")+")");currentResult.arguments=d;return currentResult}},where=function(b,c){for(var a=0,d=b.length;a<d;a++)if(!b[a])return skippedTest;return c()};function Score(){}var score=new Score;score.ok=!1;score.passed=0;score.failure=0;score.skipped=0;score.message="Test has not run";score.clear=function(){score.ok=!1;score.passed=0;score.skipped=0;score.failure=0;score.message="Test has not run";return score};
score.evaluate=function(){score.ok=0===score.failure;score.message=(score.ok?"\u2713 OK, passed "+score.passed+"":"\u2718 Failed. after "+(score.passed+score.skipped))+" tests."+(0<score.skipped?" \u2662 skipped "+score.skipped+" cases":"");return score};function Seed(){}var seed=new Seed;seed.linear=function(b,c){var a=supplement(1,b,Math.max),d=supplement(0,c);return function(b){return a*b+d}};
seed.quadratic=function(b,c,a){var d=supplement(1,b),e=supplement(0,c),f=supplement(0,a);return function(a){return d*a*a+e*a+f}};seed.exponent=function(b,c){var a=supplement(2,b,Math.max),d=supplement(1,c);return function(b){return Math.pow(a,Math.round(b*d))}};seed.logarithm=function(b,c,a){var d=supplement(1,b),e=supplement(2,c,Math.max),f=supplement(0,a);return function(a){return Math.log(a*d)/Math.log(e)+f}};function Combinator(){}var combinator=new Combinator;
combinator.sized=function(b){var c=seed.exponent(2,0.5);return function(a){a=c(a);return b(a)}};combinator.resize=function(b,c){return function(a){a=b(a);return c(a)}};combinator.choose=function(b,c){var a=Math.min(b,c),d=Math.max(b,c),e;return Math.floor(b)===b&&Math.floor(c)===c?function(){return e=Math.floor(Math.random()*(d-a+1))+a}:function(){return e=Math.random()*(d-a+1)+a}};
combinator.chooseNow=function(b,c){var a=Math.min(b,c),d=Math.max(b,c);return Math.floor(b)===b&&Math.floor(c)===c?a=Math.floor(Math.random()*(d-a+1))+a:a=Math.random()*(d-a+1)+a};combinator.elements=function(b){var c=combinator.choose(0,b.length-1);return function(){var a=c();return b[a]}};combinator.oneOf=function(b){combinator.choose(0,b.length-1);return function(c){var a=select();return b[a](c)}};
combinator.listOf=function(b,c){var a=function(a){for(var c=0,f=Math.random()*a,g=[];c<f;c++)g[c]=b(a);return g};return void 0===c?a:function(b){return c(a(b))}};combinator.listOf1=function(b){return function(c){var a=0;l_=Math.random()*c;length=1>l_?1:l_;for(result=[];a<length;a++)result[a]=b(c);return result}};combinator.vectorOf=function(b,c){return function(){for(var a=0,d=[];a<b;a++)d[a]=c();return d}};
combinator.frequency=function(b,c){var a=map(function(a){return a.fst},b),d=map(function(a){return a.snd},b),e=sumOf(a),f=combinator.choose(1,e),g=function(b){for(var c=0,e=f(),g=1;g=a[c];c++){if(e<g)return b=d[c](b);e-=g}return b=d[c-1](b)};return void 0===c?g:function(a){return c(g(a))}};function GenerateReference(){}var generateReference=new GenerateReference;
generateReference.register=function(b,c){var a=function(a,b){if("prototype"==a||"register"==a)throw Error("GenerateRefference."+a+" should not overwrite");generateReference[a]=b;return generateReference};2===arguments.length&&"string"===typeof b&&"function"===typeof c?a(b,c):each(flip(a),b);return this};
var charCodeGenerate=combinator.frequency([tuple(400,combinator.choose(65,122)),tuple(300,combinator.choose(48,57)),tuple(150,combinator.choose(31,47)),tuple(140,combinator.choose(123,127)),tuple(7,combinator.choose(128,55295)),tuple(2,combinator.choose(57344,65533)),tuple(1,combinator.choose(65536,1114111))]);
generateReference.register({"boolean":combinator.elements([!1,!0]),integer:combinator.sized(function(b){return combinator.chooseNow(-b,b)}),number:combinator.sized(function(b){var c=combinator.chooseNow,a=1E10-1,b=c(0,b),b=c(-b*a,b*a),c=c(1,a);return b/c}),charCode:charCodeGenerate,charactor:function(b){return String.fromCharCode(charCodeGenerate(b))},string:combinator.listOf(charCodeGenerate,function(b){return String.fromCharCode.apply(null,b)})});
var arbitrary=function(b,c){var a=Array.prototype.slice.call(arguments);return new arbitrary.fn.init(a)};
arbitrary.fn=arbitrary.prototype=function(){var b=/\[\s?([a-z]+)\s?\]/,c=function(a){var c=b.exec(a),e=combinator.listOf;return c?(a=c[1],a=generateReference[a],e(a)):a=generateReference[a]};return{constructor:arbitrary,init:function(a){this.length=a.length;this.types=a;return this},types:[],length:0,size:function(){return this.length},property:function(a){var b,e=this.types;try{b=map(c,e)}catch(f){console&&console.log&&console.log(f)}return forAll(b,a)},recipe:function(a){1===this.length&&a.constructor===
arbitrary&&generateReference.register(this.types[0],generateReference[a.types]);1===this.length&&"function"===typeof a?generateReference.register(this.types[0],a):1===arguments.length&&"object"===typeof arguments&&generateReference.register(arguments[0])},fmap:function(a){var b=map(c,this.types),e="adhock_"+(a.name||whatTimeIsNow())+"_("+this.types.join(", ")+")";generateReference.register(e,function(c){var e=map(function(a){return a(c)},b);return a.apply(null,e)});return arbitrary.call(null,e)},
sample:function(a){var a=supplement(10,a,function(a,b){return Math.max(1,b)}),b=0,e,f,g=[];try{e=map(c,this.types)}catch(h){console&&console.log&&console.log(h)}for(;b<a;b++)f=map(function(a){return a(b)},e),console&&console.log&&console.log(1===f.length?f[0]:f),g.push(f);return g}}}();arbitrary.fn.init.prototype=arbitrary.fn;function Checker(){}var checker=new Checker;checker.shouldRetry=!1;checker.current="";checker.why="";checker.marks={skipped:"\u2662",passed:"\u2713",faild:"\u2718"};
checker.wrapQuote=function(b){return"string"===typeof b?'"'+b+'"':b+""};checker.logging=function(b,c){var a;checker.shouldRetry=!1;b.skipped?(a="skipped",c.skipped++):b.passed?(a="passed",c.passed++):(a="faild",c.failure++,checker.shouldRetry=!0);checker.current=checker.marks[a]+" ( "+map(checker.wrapQuote,b.arguments).join(", ")+" )";checker.why=b.reason;return checker};checker.run=function(b,c,a){b=c(b);return checker.logging(b,a)};var ViewInterface=new Interface("ViewInterface","getTestCount standby clean putMsg putLog dump highlight".split(" "));
function View(){}
var createView=function(b){var c=new View,a="";for(a in b)c[a]=b[a];Interface.ensureImplements(c,ViewInterface);return c},consoleView=function(){var b="";return createView({getTestCount:function(){return 100},standby:function(){console.clear&&console.clear();b=""},clean:function(){b=""},putMsg:function(b){console.log(b)},putLog:function(c){b+=c+"\n"},dump:function(){0<b.length&&console.log(b)},highlight:function(b,a){return a}})}(),htmlView=function(){var b=[],c=0;return createView({selectors:{counter_id:"test-count",messenger_id:"test-message",
logger_id:"test-log"},setSelectors:function(a){var b=this.selectors,c="";for(c in b){if(void 0===a[c])throw Error("html-test-view need selector id :"+c+", but undefined");this.selectors[c]=a[c]}return this},getTestCount:function(){return parseInt(document.getElementById(this.selectors.counter_id).value,10)},standby:function(){b=[];c=0},clean:function(){b=[]},putMsg:function(a){document.getElementById(this.selectors.messenger_id).innerHTML=a},putLog:function(a,d){b[c]=!d?a:htmlEscape(a);c++},dump:function(){document.getElementById(this.selectors.logger_id).innerHTML=
b.join("<br>");b=[];c=0},highlight:function(a,b){return'<span class="'+(a?"passed":"failed")+'">'+b+"</span>"}})}();function Macchiato(){}var macchiato=new Macchiato;macchiato.view_=consoleView;macchiato.suites_=[];
macchiato.quickcheck=function(b,c){for(var a=macchiato.view_,d=a.getTestCount(),e=0,e=!1,e=0;e<d;e++)if(checker.run(e,b,score),checker.shouldRetry){a.putLog(checker.current,!0);checker.run(e+1,b,score);a.putLog(checker.current,!0);break}score.evaluate();e=score.ok;a.putLog(a.highlight(e,(c?c+" : ":"")+score.message));score.clear();return e};
macchiato.verbosecheck=function(b,c){for(var a=macchiato.view_,d=a.getTestCount(),e=0,e=!1,e=0;e<d;e++)if(checker.run(e,b,score),a.putLog(checker.current,!0),checker.shouldRetry){checker.run(e+1,b,score);a.putLog(checker.current,!0);break}d=score.evaluate();e=d.ok;a.putLog(a.highlight(e,(c?c+" : ":"")+d.message));score.clear();return e};macchiato.setVerbose=function(b){macchiato.view_.verbose=b;return macchiato};
macchiato.setView=function(b){Interface.ensureImplements(b,ViewInterface);macchiato.view_=b;return macchiato};macchiato.stock=function(b){macchiato.suites_.push(b);return macchiato};
macchiato.taste=function(){var b=macchiato.view_,c=b.verbose?macchiato.verbosecheck:macchiato.quickcheck,a=!0,d=0,e=macchiato.suites_,f,g,h=whatTimeIsNow();for(b.standby();f=e[d];d++)for(label in f)g=f[label],a=c(g,label)&&a;c=whatTimeIsNow();b.dump();d=whatTimeIsNow();b.putMsg((a?"Ok, All tests succeeded!!":"Oops! failed test exist...")+" ( testing: "+printTime(h,c)+", log rendering: "+printTime(c,d)+" )");return macchiato};
