var force=function(a){return a()},flip=function(a){return function(c,b){return a(b,c)}},isList=function(a){for(var c=[Array,NodeList,HTMLCollection],b,d=0;b=c[d];d++)if(a instanceof b)return!0;return!1},isEmpty=function(){for(var a in obj)return!1;return!0},map=function(a,c){var b,d,e;if(isList(c)){b=[];d=0;for(e=c.length;d<e;d++)b[d]=a(c[d],d);return b}b={};for(d in c)c.hasOwnProperty(d)&&(b[d]=a(c[d],d));return b},each=function(a,c){var b,d;if(isList(c)){b=0;for(d=c.length;b<d;b++)a(c[b],b)}else for(b in c)c.hasOwnProperty(b)&&
a(c[b],b)},filter=function(a,c){for(var b=[],d=0,e=0,f=c.length,g;d<f;d++)g=c[d],a(g,d)&&(b[e]=g,e++);return b},hasAny=function(a,c){for(var b=0,d=c.length;b<d;b++)if(a(c[b],b))return!0;return!1},hasAll=function(a,c){for(var b=0,d=c.length;b<d;b++)if(!a(c[b],b))return!1;return!0},foldLeft=function(a,c,b){for(var d=0,e=b.length;d<e;d++)a=c(b[d],a);return a},foldRight=function(a,c,b){for(var d=b.length-1;-1<d;d--)a=c(b[d],a);return a},sumOf=function(a){for(var c=0,b=0,d=a.length;b<d;b++)c+=a[b];return c},
supplement=function(a,c,b){return void 0===c?a:void 0===b?c:b(a,c)},Tuple=function(a,c){this.fst=a;this.snd=c},tuple=function(a,c){return new Tuple(a,c)},Interface=function(a,c){if(2!=arguments.length)throw Error("Interface constructor called with "+arguments.length+"arguments, but expected exactly 2.");this.name=a;this.methods=[];for(var b=0,d=c.length;b<d;b++){if("string"!==typeof c[b])throw Error("Interface constructor expects method names to be passed in as a string");this.methods.push(c[b])}};
Interface.ensureImplements=function(a,c,b){if(2>arguments.length)throw Error("Function Interface.ensureImplements called with "+arguments.length+"arguments, but expected at least 2.");for(var d=1,e=0,f,g;g=arguments[d];d++){if(g.constructor!==Interface)throw Error("Function Interface.ensureImplements expects arguments two and above to be instance of Interface.");for(;f=g.methods[e];e++)if(!a[f]||"function"!==typeof a[f])throw Error("Function Interface.ensureImplements: object does not implement the "+
g.name+" interface. Method "+f+" was not found.");}};
var Result=function(a){this.passed=a.passed;this.skipped=a.skipped;this.reason=a.reason;this.arguments=a.arguments;return this},forAll=function(a,c){var b=isList(a)?a:[b],d=[],e=!1,f="",g;return function(){d=map(force,b);try{g=c.apply(c,d);if(g.wasSkipped)return f="Skipped: ("+d.join(", ")+")",new Result({passed:!1,skipped:!0,reason:f,arguments:d});f=(successs=g)?"":"Falsible: ("+d.join(", ")+")"}catch(a){e=!1,f="Exception occurred: "+a}return new Result({passed:e,skipped:!1,reason:f,arguments:d})}},
where=function(a,c){for(var b=0,d=a.length,e;b<d;b++)if(e=!a[b])return{wasSkipped:!0};return c()},score=function(){var a=new function(){this.ok=!1;this.skipped=this.failure=this.passed=0;this.message="Test has not run";return this};a.clear=function(){this.ok=!1;this.failure=this.skipped=this.passed=0;this.message="Test has not run";return this};a.evaluate=function(){this.ok=0===this.failure;this.message=(this.ok?"\u2713 OK, passed "+this.passed+"":"\u2718 Failed. after "+this.passed+this.skipped)+
" tests."+(0<this.skipped?" \u2662 skipped "+this.skipped+" cases":"");return this};return a}(),seed=function(){var a=new function(){},c=1,b=function(b){return Math.round(Math.random()*b)};a.linear=function(a,e){var f=supplement(1,a,Math.max),g=supplement(0,e);return b(f*c+g)};a.quadratic=function(a,e,f){a=supplement(1,a);e=supplement(0,e);f=supplement(0,f);return b(a*c*c+e*c+f)};a.exponent=function(a,e){var f=supplement(2,a,Math.max),g=supplement(1,e),f=Math.pow(f,Math.round(c*g));return b(f)};a.logarithm=
function(a,e,f){a=supplement(1,a);e=supplement(2,e,Math.max);f=supplement(0,f);f=Math.log(c*a)/Math.log(e)+f;return b(f)};a.grow=function(){c++;return c};a.clear=function(){c=1};return a}(),combinator=function(){var a=new function(){};a.sized=function(a){var b,d;return function(e){b=seed.exponent(2,2/3);d=supplement(b,e);return a(d)}};a.resize=function(a,b){return function(){return b(a)}};a.choose=function(a,b){var d,e;return function(){d=Math.random()*a;e=Math.random()*b;return Math.min(b,Math.max(a,
d+e))}};a.elements=function(c){var b=a.choose,d=c.length,e=0;return function(){e=~~b(0,d)();return c[e]}};a.oneOf=function(c){var b=a.elements(c);return function(){return b()()}};a.listOf=function(c){var b=seed.linear,d=a.resize,e=a.vectorOf,f=function(a){return e(a,c)()};return function(){return d(b(2),f)()}};a.listOf1=function(c){var b=seed.linear,d=a.vectorOf,e=a.resize,f=function(a){return d(a,c)()};return function(){return e(b(2,1),f)()}};a.vectorOf=function(a,b){var d=0,e=[];return function(){d=
0;for(e=[];d<a;d++)e[d]=b();return e}};a.frequency=function(c){var b=a.choose,d=map(function(a){return a.fst},c),e=map(function(a){return a.snd},c),f=sumOf(d),g=0,i,h;return function(){h=b(1,f)();for(g=0;i=d[g];g++){if(h<i)return e[g]();h-=i}return e[g-1]()}};return a}(),generateReference=function(){var a=combinator.choose,c=combinator.listOf,b=combinator.frequency,d=combinator.sized,e=combinator.elements,f=new function(){},g,i,h,m=b([tuple(400,a(65,122)),tuple(300,a(48,57)),tuple(150,a(31,47)),tuple(140,
a(123,127)),tuple(7,a(128,55295)),tuple(2,a(57344,65533)),tuple(1,a(65536,1114111))]),j=65,k=function(){j=m();return Math.round(j)},l=c(k),n=function(a,b){if("prototype"==a||"register"==a)throw Error("GenerateRefference."+a+" should not overwrite");f[a]=b;return f};f.register=function(a,b){2===arguments.length&&"string"===typeof a&&"function"===typeof b?n(a,b):each(flip(n),a);return this};f.register({"boolean":e([!1,!0]),integer:d(function(b){b=a(-b,b)();return Math.round(b)}),number:d(function(b){g=
a(0,b)();i=a(1E16*-g,1E16*g)();h=a(1,1E16)();return i/h}),charCode:k,charactor:function(){return String.fromCharCode(k())},string:function(){return String.fromCharCode.apply(null,l())}});return f}(),arbitrary=function(a,c){var b=Array.prototype.slice.call(arguments);return new arbitrary.fn.init(b)};
arbitrary.fn=arbitrary.prototype=function(){var a=/\[\s?([a-z]+)\s?\]/,c=function(b){var c=a.exec(b),e=combinator.listOf;return c?e(generateReference[c[1]]):generateReference[b]};return{constructor:arbitrary,init:function(a){this.length=a.length;this.types=a;return this},types:[],length:0,size:function(){return this.length},property:function(a){var d,e=this.types;try{d=map(c,e)}catch(f){console&&console.log&&console.log(f)}return forAll(d,a)},sample:function(a){var a=supplement(10,a,function(a,b){return Math.max(1,
b)}),d,e,f=[];try{d=map(c,this.types)}catch(g){console&&console.log&&console.log(g)}for(seed.clear();a;a--)e=map(force,d),console&&console.log&&console.log(1===e.length?e[0]:e),f.push(e),seed.grow();return f}}}();arbitrary.fn.init.prototype=arbitrary.fn;
var checker=function(){var a={skipped:"\u2662",passed:"\u2713",faild:"\u2718"},c=new function(){this.args=[];this.skipped=this.passed=!1;this.currentLog="";return this};c.run=function(a,c,e){a=a();this.args=a.arguments;a.skipped?this.skipped=!0:(this.skipped=!1,this.passed=a);this.log(c,e)};c.log=function(b,c){var e;this.skipped?(e="skipped",c.skipped++):this.passed?(e="passed",c.passed++):(e="faild",c.failure++,this.shouldView=!0);this.currentLog=a[e]+" ( "+map(function(a){return typeof a==="string"?
'"'+a+'"':a+""},this.args).join(", ")+" )"};return c}(),ViewInterface=new Interface("ViewInterface","getTestCount standby clean putMsg putLog dump highlight".split(" ")),View=function(){},createView=function(a){var c=new View,b="";for(b in a)c[b]=a[b];Interface.ensureImplements(c,ViewInterface);return c},consoleView=function(){var a="";return createView({getTestCount:function(){return 100},standby:function(){console.clear&&console.clear();a=""},clean:function(){a=""},putMsg:function(a){console.log(a)},
putLog:function(c){a+=c+"\n"},dump:function(){0<a.length&&console.log(a)},highlight:function(a,b){return b}})}(),htmlView=function(){var a=[],c=0;return createView({selectors:{counter_id:"test-count",messenger_id:"test-message",logger_id:"test-log"},setSelectors:function(a){var c=this.selectors,e="";for(e in c){if(void 0===a[e])throw Error("html-test-view need selector id :"+e+", but undefined");this.selectors[e]=a[e]}return this},getTestCount:function(){return parseInt(document.getElementById(this.selectors.counter_id).value,
10)},standby:function(){a=[];c=0},clean:function(){a=[]},putMsg:function(a){document.getElementById(this.selectors.messenger_id).innerHTML=a},putLog:function(b,d){a[c]=!d?b:htmlEscape(b);c++},dump:function(){document.getElementById(this.selectors.logger_id).innerHTML=a.join("<br>");a=[];c=0},highlight:function(a,c){return'<span class="'+(a?"passed":"failed")+'">'+c+"</span>"}})}(),macchiato=function(){var a=new function(){},c=consoleView,b=[];a.setVerbose=function(a){c.verbose=a;return this};a.setView=
function(a){Interface.ensureImplements(a,ViewInterface);c=a;return this};a.stock=function(a){b.push(a);return this};a.taste=function(){var a=!0,e=0,f,g="",i;for(c.standby();f=b[e];e++)for(g in f)if(i=f[g],a){for(var a=g,h=c.verbose,m=c.getTestCount(),j=!0,k="",l=void 0;m;m--)checker.run(i,h,score),(h||checker.shouldView)&&c.putLog(checker.currentLog,!0),seed.grow();l=score.evaluate();k=a+" : "+l.message;c.putLog(c.highlight(l.ok,k));j=j&&l.ok;score.clear();seed.clear();a=j}c.dump();c.putMsg(a?"Ok, All tests succeeded!!":
"Oops! failed test exist...");return this};return a}();window.macchiato=macchiato;
